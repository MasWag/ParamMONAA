box: maswag/tgrep-env

build:
  steps:
    - script:
        name: default_build
        code: |
          mkdir build
          cd build && cmake .. && make
gcc_unit_test:
  steps:
    - script:
        name: set_gcc_env
        code: |
          export CC=/usr/bin/gcc
          export CXX=/usr/bin/g++
    - script:
        name: build_and_test
        code: |
          mkdir build
          cd build && cmake .. && make && make test
clang_unit_test:
  steps:
    - script:
        name: set_clang_env
        code: |
          export CC=/usr/bin/clang
          export CXX=/usr/bin/clang++
    - script:
        name: build_and_test
        code: |
          mkdir build
          cd build && cmake .. && make && make test
update_doxygen:
  steps:
    - script:
        name: setup
        code: |
          sudo pacman -S doxygen --noconfirm
    - script:
        name: clone_doc
        code: |
          git clone -b gh-pages git@github.com:MasWag/monaa.git ~/monaa-doc
    - script:
        name: build_doxygen
        code: |
          mkdir libmonaa/build
          cd libmonaa/build && cmake .. && make doc && cp -r doc/html ~/monaa-doc
    - script:
        name: push_doc
        code: |
          cd ~/monaa-doc/ && git ci -am 'doxygen updated'; git push
